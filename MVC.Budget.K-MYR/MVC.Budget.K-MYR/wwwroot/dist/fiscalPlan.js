"use strict";(self.webpackChunkthebudgeteer=self.webpackChunkthebudgeteer||[]).push([[308],{584:(e,t,a)=>{a(57),a(200),a(698);var n=a(99),o=a(417),i=a(933),d=a(681),s=a(438),r=a(17);const c=new Date,l=document.getElementById("fiscalPlan_Id"),u=document.getElementById("menu-container"),m=document.getElementById("antiforgeryToken"),g=(0,i._v)(),y=async function(e,t,n,o){try{const{default:i}=await Promise.all([a.e(393),a.e(245)]).then(a.bind(a,904));return await g,new i(e,t,n,o)}catch(e){s.A.addAndShow("A critical error occurred. Please reload the page","#cross-icon",!1)}}(u,l.value,c,JSON.parse(l.dataset.object)),h=async function(e,t){try{const{default:n}=await Promise.all([a.e(393),a.e(413)]).then(a.bind(a,352));return await g,new n(e,t)}catch(e){s.A.addAndShow("A critical error occurred. Please reload the page","#cross-icon",!1)}}(l.value,c),f=async function(e){try{const{default:t}=await a.e(997).then(a.bind(a,152));return new t(e)}catch(e){s.A.addAndShow("A critical error occurred. Please reload the page","#cross-icon",!1)}}(m.value),v=(0,i.Ck)().catch((()=>{s.A.addAndShow("A critical error occurred. Please reload the page","#cross-icon",!1)})),p=((0,i.E0)().then((()=>{r(".accordion-head").on("click keydown",(function(e){if(("click"===e.type||"keydown"===e.type&&"Enter"===e.key)&&!e.target.classList.contains("addCategory-icon")){let e=r(this).next();e[0].classList.contains("collapsing")||(e.collapse("toggle"),r(".accordion-caret",this)[0].classList.toggle("rotate"))}}))})).catch((()=>{s.A.addAndShow("A critical error occurred. Please reload the page","#cross-icon",!1)})),async function(){try{const{default:o}=await a.e(897).then(a.bind(a,374));var e={start:0,lastId:null,lastValue:null},t=new o("#transactions-table",{processing:!0,serverSide:!0,deferLoading:0,ajax:function(t,a,o){var i=new FormData(document.getElementById("search-form")),d=new r.fn.dataTable.Api(o),c=i.get("SearchString"),l=i.get("MinDate"),u=i.get("MaxDate"),m=i.get("FiscalPlanId"),g=i.get("CategoryId"),y=i.get("MinAmount"),h=i.get("MaxAmount"),f=!1,v=null,p=null,w=null,I=null;if(t.order?.[0]&&(w=t.order[0].name,I=t.order[0].dir),0!==t.start){let a=null;e.start!==t.start?a=(f=e.start>t.start)?d.row(":first").data():d.row(":last").data():(v=e.lastId,p=e.lastValue),a&&(v=a.id,w&&(p=a[w]))}var E={draw:t.draw,start:t.start,pageSize:t.length,orderBy:w,orderDirection:"asc"===I?0:1,lastId:v,lastValue:p,isPrevious:f,FiscalPlanId:m.length>0?parseInt(m):null,SearchString:c.length>0?c:null,CategoryId:g.length>0?parseInt(g):null,MinDate:l.length>0?l:null,MaxDate:u.length>0?u:null,MinAmount:y.length>0?parseFloat(y):null,MaxAmount:h.length>0?parseFloat(h):null};r.ajax({url:n.Q.transactions.GET_SEARCH,type:"POST",contentType:"application/json",headers:{RequestVerificationToken:i.get("__RequestVerificationToken")},data:JSON.stringify(E),success:function(n){a({draw:n.draw,recordsFiltered:t.start+n.transactions.length+(!0===n.hasNext?1:0),data:n.transactions}),e={start:E.start,lastId:E.lastId,lastValue:E.lastValue}},error:function(e,t,a){s.A.addAndShow("Failed to fetch data.Please try again.","#cross-icon")}})},info:!1,layout:{topStart:null,topEnd:null,bottomStart:"pageLength",bottomEnd:{paging:{type:"simple",numbers:!1}}},lengthMenu:[10,25,50],columns:[{data:"title",render:o.render.text(),name:"title"},{data:"dateTime",name:"dateTime"},{data:"amount",name:"amount"},{data:"category",render:o.render.text(),name:"category.name"},{data:null,defaultContent:'<div class="d-flex justify-content-center align-items-center flex-wrap gap-2">\n                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" class="table-icon" data-icon="edit" tabindex="0">\n                            <use href="#edit-icon"/>\n                        </svg >\n                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" class="table-icon" viewBox="0 0 16 16" data-icon="delete" tabindex="0">\n                            <use href="#trash-icon"/>\n                        </svg>\n                    </div>',targets:-1,sortable:!1}],columnDefs:[{targets:2,render:function(e,t,a){return"display"===t?window.userNumberFormat.format(e):e}},{targets:1,render:function(e,t,a){return"display"===t?new Date(e).toLocaleString(window.userLocale):e}}],scrollX:!0,scrollCollapse:!0});return t}catch(e){s.A.addAndShow("A critical error occurred. Please reload the page","#cross-icon",!1)}}());var w,I,E,b;function S(){if(u.classList.contains("active")){var e=u.dataset.categoryid;document.getElementById(`category_${e}`).querySelector(".border-animation").classList.remove("border-rotate"),u.dataset.categoryid=0,u.classList.remove("active")}}!async function(){const e=(await Promise.all([a.e(699),a.e(441)]).then(a.t.bind(a,361,23))).default;[...document.querySelectorAll(".tooltipped")].map((t=>new e(t,{container:"body",delay:{show:500,hide:0},offset:[0,10],placement:(e,t)=>{var a=window.matchMedia("(min-width: 576px)");return e._element.classList.contains("sidebar-button-container")&&a.matches?"right":"top"}})))}(),w=["face_0","face_1","face_2","face_3"],I=document.getElementById("flip-container-inner"),E=0,b=0,r("#action-sidebar").on("click",".sidebar-button-container",(function(){this.blur();var e=parseInt(this.dataset.index);if(E!==e){var t=document.getElementById(w[E]),a=document.getElementById(w[e]);0==E&&S();var n=(0,o.Y0)(E,e);b+=n,I.style=`transform: rotateY(${b}deg)`,t.classList.remove("visible-face"),a.classList.add("visible-face"),a.removeAttribute("inert"),t.setAttribute("inert",""),a.setAttribute("aria-hidden","false"),t.setAttribute("aria-hidden","true"),E=e}})),I.addEventListener("transitionend",(e=>{"transform"==e.propertyName&&(b%=360,I.style=`transform: rotateY(${b}deg); transition: transform 0s`)})),async function(e,t,a){var o=await e,i=await t,c=o.find((e=>"addCategory-modal"==e._element.id)),m=o.find((e=>"updateCategory-modal"==e._element.id)),g=o.find((e=>"deleteCategory-modal"==e._element.id)),y=o.find((e=>"addTransaction-modal"==e._element.id));(function(e,t){var a=document.getElementById("addCategory_type"),n=document.getElementById("addCategory_fiscalPlanId");document.getElementById("addCategory-form").addEventListener("submit",(async function(a){if(a.preventDefault(),e._isShown&&r(this).valid()){e.hide();let a=await(0,d.Vd)(new FormData(this));a.isSuccess&&t.addCategory(a.data),s.A.addAndShow(a.message,a.isSuccess?"#check-icon":"#cross-icon")}})),r(".addCategory-icon").on("click keydown",(function(t){if("click"===t.type||"keydown"===t.type&&"Enter"===t.key){var o=r(this).closest(".accordion")[0].dataset.type;a.value=o,n.value=l.value,e.show()}}))})(c,i),function(e,t){var a=document.getElementById("updateCategory-label"),n=document.getElementById("updateCategory_id"),o=document.getElementById("updateCategory_name"),i=document.getElementById("updateCategory_budget"),c=document.getElementById("updateCategory_type"),m=document.getElementById("updateCategory_fiscalPlanId");document.getElementById("updateCategory-form").addEventListener("submit",(async function(a){if(a.preventDefault(),e._isShown&&r(this).valid()){e.hide();let a=t.getCurrentMonth(),n=new FormData(this),o=await(0,d.uv)(n,a);o.isSuccess&&t.editCategory(n,a),s.A.addAndShow(o.message,o.isSuccess?"#check-icon":"#cross-icon")}})),document.getElementById("edit-menu").addEventListener("click",(function(){let d=t.getCategory(u.dataset.categoryid);a.textContent=`Edit '${d.name}'`,n.value=d.id,o.value=d.name,i.value=d.budgetLimit?.budget??d.budget,c.value=d.categoryType,m.value=l.value,e.show()}))}(m,i),function(e,t){var a=document.getElementById("addTransaction_categoryId");document.getElementById("addTransaction-form").addEventListener("submit",(async function(a){if(a.preventDefault(),e._isShown&&r(this).valid()){e.hide();let a=await(0,d.LP)(new FormData(this));a.isSuccess&&t.addTransaction(a.data),s.A.addAndShow(a.message,a.isSuccess?"#check-icon":"#cross-icon")}})),document.getElementById("add-menu").addEventListener("click",(function(){a.value=u.dataset.categoryid,e.show()}))}(y,i),function(e,t,a){var n=document.getElementById("deleteCategory-label"),o=document.getElementById("deleteCategory_id"),i=document.getElementById("deleteCategory_type");document.getElementById("deleteCategory-form").addEventListener("submit",(async function(n){if(n.preventDefault(),e._isShown){e.hide();let n=new FormData(this),o=parseInt(n.get("Id")),i=parseInt(n.get("Type")),r=n.get("__RequestVerificationToken"),c=await(0,d.K7)(o,i,r);c.isSuccess&&(t.removeCategory(o,i),a.removeCategory(o),u.classList.remove("active"),u.dataset.categoryid=0),s.A.addAndShow(c.message,c.isSuccess?"#check-icon":"#cross-icon")}})),document.getElementById("delete-menu").addEventListener("click",(function(){var a=t.getCategory(u.dataset.categoryid);n.textContent=`Delete '${a.name}'`,i.value=a.categoryType,o.value=u.dataset.categoryid,e.show()}))}(g,i,await a),document.getElementById("close-menu").onclick=S,document.getElementById("details-menu").onclick=function(){var e=u.dataset.categoryid;window.location.href=n.d.CATEGORY(e)},i.attachMenuHandlers()}(v,y,f),async function(e,t){var a=await e;r("#search-form").on("submit",(async function(e){e.preventDefault(),r(this).valid()&&a.ajax.reload(null,!0)}));var n=await t,o=n.find((e=>"updateTransaction-modal"==e._element.id)),i=n.find((e=>"deleteTransaction-modal"==e._element.id));(function(e,t){document.getElementById("updateTransaction-form").addEventListener("submit",(async function(a){if(a.preventDefault(),e._isShown&&r(this).valid()){e.hide();let a=new FormData(this),n=await(0,d.IQ)(a);if(n.isSuccess){let e=t.row(((e,t)=>t.id===parseInt(a.get("Id"))));if(e){let t=e.data();t.amount=parseFloat(a.get("Amount")),t.title=a.get("Title"),t.dateTime=a.get("DateTime"),t.isHappy="true"===a.get("IsHappy"),t.isNecessary="true"===a.get("IsNecessary"),t.isEvaluated="true"===a.get("IsEvaluated"),t.previousIsHappy="true"===a.get("PreviousIsHappy"),t.PreviousIsNecessary="true"===a.get("PreviousIsNecessary"),e.invalidate()}}s.A.addAndShow(n.message,n.isSuccess?"#check-icon":"#cross-icon")}}))})(o,a),function(e,t){document.getElementById("deleteTransaction-form").addEventListener("submit",(async function(a){if(a.preventDefault(),e._isShown){e.hide();let a=new FormData(this),n=parseInt(a.get("Id")),o=a.get("__RequestVerificationToken"),i=await(0,d.Uw)(n,o);if(i.isSuccess){let e=t.row(((e,t)=>t.id===parseInt(a.get("Id"))));e&&e.remove().draw()}s.A.addAndShow(i.message,i.isSuccess?"#check-icon":"#cross-icon")}}))}(i,a);var c=document.getElementById("updateTransaction_id"),l=document.getElementById("updateTransaction-label"),u=document.getElementById("updateTransaction_title"),m=document.getElementById("updateTransaction_datetime"),g=document.getElementById("updateTransaction_amount"),y=document.getElementById("updateTransaction_isHappyTrue"),h=document.getElementById("updateTransaction_isHappyFalse"),f=document.getElementById("updateTransaction_isNecessaryTrue"),v=document.getElementById("updateTransaction_isNecessaryFalse"),p=document.getElementById("deleteTransaction-label"),w=document.getElementById("deleteTransaction_id");a.on("click keydown","svg",(function(e){if("click"===e.type||"keydown"===e.type&&"Enter"===e.key){var t=a.row(e.target.closest("tr")).data();switch(this.dataset.icon){case"edit":c.value=t.id,l.textContent=`Edit '${t.title}'`,u.value=t.title,m.value=t.dateTime.slice(0,19),g.value=t.amount;let e=t.isHappy?y:h;e.checked=!0,e=t.isNecessary?f:v,e.checked=!0,o.show();break;case"delete":w.value=t.id,p.textContent=`Delete '${t.title}'`,i.show()}}})),document.getElementById("table-container").style="",a.columns.adjust()}(p,v),async function(e,t,a,n){var[o,i,d,s]=await Promise.all([e,t,a,n]);window.addEventListener("countryChanged",(()=>{setTimeout((()=>o.formatDashboard()),0),setTimeout((()=>d.formatDashboard()),0),setTimeout((()=>i.formatDashboard()),0),setTimeout((()=>s.rows().invalidate().draw()),0)}))}(y,h,f,p),function(){var e;r(".modal").on("show.bs.modal",(function(){e=document.activeElement})),r(".modal").on("hidden.bs.modal",(function(){e&&e.focus()}));var t=u.querySelector("#close-button-menu");u.addEventListener("transitionend",(function(a){"visibility"===a.propertyName&&u.classList.contains("active")&&(e=document.activeElement,t.focus())})),u.addEventListener("transitionstart",(function(t){"visibility"===t.propertyName&&(u.classList.contains("active")||e.focus())}))}()}},e=>{e.O(0,[279,805,22],(()=>(584,e(e.s=584)))),e.O()}]);