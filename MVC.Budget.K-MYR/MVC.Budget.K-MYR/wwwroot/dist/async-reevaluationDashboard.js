"use strict";(self.webpackChunkthebudgeteer=self.webpackChunkthebudgeteer||[]).push([[997],{152:(e,t,a)=>{a.d(t,{default:()=>d});var n=a(681),i=a(438),s=a(17);class d{#e;#t;#a;#n;#i;constructor(e){this.#i=e,this.#e=null,this.#s()}async#s(){try{this.#t=!0,this.#a=document.getElementById("reevalCategories-container"),this.#n=document.getElementById("reevalInfo"),this.#d(),this.#o()}finally{this.#t=!1,this.formatDashboard()}}async#r(e){var t=new FormData(e),a=t.get("Id"),d=document.getElementById(`reeval_transaction_${a}`),o="true"===d.dataset.ishappy,r="true"===d.dataset.isnecessary,l=await(0,n.b9)(t,o,r,this.#i);if(i.A.addAndShow(l.message,l.isSuccess?"#check-icon":"#cross-icon"),l.isSuccess){let t=s(e).closest(".accordion");if(d.removeEventListener("submit",this.#l),d.remove(),t){let e=t.find(".accordion-body")[0],a=parseInt(t[0].dataset.categoryid),s=document.getElementById(`spinner_${a}`);if(e.childElementCount<6&&s){s.classList.remove("invisible");let t=e.children[e.childElementCount-2],d=t.dataset.date,o=await(0,n.MJ)(a,d,parseInt(t.dataset.id),6);o.isSuccess&&o.data.length>0?(this.#c(o.data,e,s),s.classList.add("invisible")):(s.remove(),i.A.addAndShow(o.message,o.isSuccess?"#check-icon":"#cross-icon"))}0===e.childElementCount&&t.remove()}this.#o()}}#d(){s(".reevaluate-transaction-form").on("submit",this.#l.bind(this))}#l(e){e.preventDefault(),this.#r(e.target)}formatDashboard(){try{if(this.#t)return i.A.addAndShow("The dashboard is loading...","#info-icon"),!1;if(this.#t=!0,this.#e)for(let e=0;e<this.#e.length;e++){let t=this.#e[e];for(let e=0;e<t.transactions.length;e++){let a=t.transactions[e],n=document.getElementById(`transaction_date_${a.id}`);n.textContent=new Date(a.dateTime).toLocaleDateString(window.userLocale),n=document.getElementById(`transaction_amount_${a.id}`),n.textContent=window.userNumberFormat.format(a.amount)}}else{let e=s(".transaction-body",this.#a);for(let t=0;t<e.length;t++){let a=e[t],n=parseInt(a.dataset.id),i=new Date(a.dataset.date),s=parseFloat(a.dataset.amount),d=document.getElementById(`transaction_date_${n}`);d.textContent=i.toLocaleDateString(window.userLocale),d=document.getElementById(`transaction_amount_${n}`),d.textContent=window.userNumberFormat.format(s)}}}finally{this.#t=!1}}removeCategory(e){let t=document.getElementById(`accordion_${e}`);t&&t.remove(),this.#o()}#m(e){var t=document.createElement("div");t.id=`reeval_transaction_${e.id}`,t.className="transaction-body",t.setAttribute("data-id",e.id),t.setAttribute("data-ishappy",e.isHappy),t.setAttribute("data-isnecessary",e.isNecessary),t.setAttribute("data-amount",e.amount),t.setAttribute("data-date",e.dateTime);var a=document.createElement("div");a.textContent=decodeURIComponent(e.title);var n=document.createElement("div");n.id=`transaction_date_${e.id}`,n.textContent=new Date(e.dateTime).toLocaleDateString(window.userLocale);var i=document.createElement("div");i.id=`transaction_amount_${e.id}`,i.textContent=window.userNumberFormat.format(e.amount);var s=document.createElement("form");s.id=`reevaluate-transaction-form_${e.id}`,s.setAttribute("novalidate","novalidate"),s.addEventListener("submit",this.#l.bind(this));var d=document.createElement("input");d.type="hidden",d.value=e.id,d.id=`reeval_transaction_${e.id}`,d.name="Id";var o=document.createElement("div");o.className="reevalIconsContainer";var r=document.createElement("div");r.className="d-flex align-items-center";var l=document.createElement("input");l.type="radio",l.value="true",l.id=`isHappyTrue_${e.id}`,l.className="iconRadioButton",l.name="IsHappy";var c=document.createElement("label");c.className="reevalIconLabel",c.htmlFor=`isHappyTrue_${e.id}`;var m=document.createElement("img");m.src="/dist/img/happy-emote.svg",m.height=25,m.width=25,m.className="reevalIcon";var u=document.createElement("input");u.type="radio",u.value="false",u.id=`isHappyFalse_${e.id}`,u.className="iconRadioButton",u.checked=!0,u.name="IsHappy";var h=document.createElement("label");h.className="reevalIconLabel",h.htmlFor=`isHappyFalse_${e.id}`;var p=document.createElement("img");p.src="/dist/img/sad-emote.svg",p.height=25,p.width=25,p.className="reevalIcon";var v=document.createElement("div");v.className="d-flex align-items-center";var g=document.createElement("input");g.type="radio",g.value="true",g.id=`isNecessaryTrue_${e.id}`,g.className="iconRadioButton",g.name="IsNecessary";var y=document.createElement("label");y.className="reevalIconLabel",y.htmlFor=`isNecessaryTrue_${e.id}`;var b=document.createElement("img");b.src="/dist/img/chart-growth.svg",b.height=25,b.width=25,b.className="reevalIcon";var E=document.createElement("input");E.type="radio",E.value="false",E.checked=!0,E.id=`isNecessaryFalse_${e.id}`,E.className="iconRadioButton",E.name="IsNecessary";var f=document.createElement("label");f.className="reevalIconLabel",f.htmlFor=`isNecessaryFalse_${e.id}`;var C=document.createElement("img");C.src="/dist/img/chart-decrease.svg",C.height=25,C.width=25,C.className="reevalIcon";var w=document.createElement("div"),I=document.createElement("button");I.className="reeval-submit-button",I.type="submit";var _=document.createElementNS("http://www.w3.org/2000/svg","svg");return _.setAttribute("class","reeval-submit-svg"),_.setAttribute("viewBox","0 0 24 24"),_.setAttribute("height","40"),_.setAttribute("width","40"),_.innerHTML='<circle cx="12" cy="12" r="11.5" stroke-width="1"></circle>\n                            <path d="M8.5 12.5L10.5 14.5L15.5 9.5" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>',c.appendChild(m),h.appendChild(p),r.appendChild(l),r.appendChild(c),r.appendChild(u),r.appendChild(h),y.appendChild(b),f.appendChild(C),v.appendChild(g),v.appendChild(y),v.appendChild(E),v.appendChild(f),I.appendChild(_),w.appendChild(I),o.appendChild(r),o.appendChild(v),o.appendChild(w),s.appendChild(d),s.appendChild(o),t.appendChild(a),t.appendChild(n),t.appendChild(i),t.appendChild(s),t}#c(e,t,a){if(e&&t){let n=document.createDocumentFragment();for(let i=0;i<e.length;i++)n.appendChild(this.#m(e[i])),a?t.insertBefore(n,a):t.appendChild(n)}}#o(){0==this.#a.childElementCount?this.#n.style.display="block":this.#n.style.display="none"}}}}]);